import{k as n,u as F,j as w,w as x,e as C}from"./index-d63ee538.js";import{r as q}from"./vendor-021dee49.js";import{u as v}from"./router-3052588b.js";import{C as b}from"./ChatBubbleLeftIcon-5a8a0035.js";const _={sendFriendRequest:async(e,t="")=>{var s,r;try{return(await n.post("/friendships/request",{recipientId:e,message:t})).data}catch(a){throw new Error(((r=(s=a.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to send friend request")}},acceptFriendRequest:async e=>{var t,s;try{return(await n.put(`/friendships/accept/${e}`)).data}catch(r){throw new Error(((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to accept friend request")}},declineFriendRequest:async e=>{var t,s;try{return(await n.put(`/friendships/decline/${e}`)).data}catch(r){throw new Error(((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to decline friend request")}},getFriends:async()=>{try{return(await n.get("/friendships")).data.friends||[]}catch{throw new Error("Failed to get friends")}},getPendingRequests:async()=>{try{return(await n.get("/friendships/requests/pending")).data.requests||[]}catch{throw new Error("Failed to get pending requests")}},getSentRequests:async()=>{try{return(await n.get("/friendships/requests/sent")).data.requests||[]}catch{throw new Error("Failed to get sent requests")}},removeFriend:async e=>{var t,s;try{return(await n.delete(`/friendships/${e}`)).data}catch(r){throw new Error(((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to remove friend")}},blockUser:async e=>{var t,s;try{return(await n.post(`/friendships/block/${e}`)).data}catch(r){throw new Error(((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to block user")}},getFriendshipStatus:async e=>{try{return(await n.get(`/friendships/status/${e}`)).data}catch{throw new Error("Failed to get friendship status")}},getMutualFriends:async e=>{try{return(await n.get(`/friendships/mutual/${e}`)).data.mutualFriends||[]}catch{throw new Error("Failed to get mutual friends")}},searchFriends:async e=>{try{return(await n.get(`/friendships/search?query=${encodeURIComponent(e)}`)).data.friends||[]}catch{throw new Error("Failed to search friends")}}},j=({targetUser:e,className:t="",size:s="md"})=>{const{user:r}=F(),a=v(),[h,p]=q.useState(!1),f=async()=>{var l;if(!(!e||e._id===r._id)){p(!0);try{const c=window.innerWidth<1024,d=[r._id,e._id].sort().join("-");let i=null;try{const u=(l=(await x.getChats()).chats)==null?void 0:l.find(y=>y.participants.some(E=>E._id===e._id));u&&(i=u._id)}catch(o){console.log("No existing chats found or error fetching chats:",o)}if(i)if(c)a(`/chat/${i}`);else{const o=document.querySelector("[data-chat-toggle]");o?o.click():window.dispatchEvent(new CustomEvent("openChat",{detail:{chatId:i}})),setTimeout(()=>{window.dispatchEvent(new CustomEvent("selectChat",{detail:{chatId:i,targetUser:e}}))},100)}else if(c)a(`/chat/${d}`);else{const o=document.querySelector("[data-chat-toggle]");o?o.click():window.dispatchEvent(new CustomEvent("openChat",{detail:{chatId:d}})),setTimeout(()=>{window.dispatchEvent(new CustomEvent("selectChat",{detail:{chatId:d,targetUser:e}}))},100)}}catch(c){console.error("Error opening chat:",c),C.error("Failed to open chat. Please try again.")}finally{p(!1)}}},m={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},g={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};return!e||e._id===r._id?null:w.jsxs("button",{onClick:f,disabled:h,className:`
        inline-flex items-center justify-center
        bg-gradient-to-r from-purple-600 to-pink-600 
        hover:from-purple-700 hover:to-pink-700 
        text-white font-medium rounded-xl
        transition-all duration-200 transform hover:scale-105
        disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
        shadow-lg hover:shadow-xl
        ${m[s]}
        ${t}
      `,children:[w.jsx(b,{className:`${g[s]} mr-2`}),h?"Opening...":"Chat"]})};export{j as S,_ as f};
