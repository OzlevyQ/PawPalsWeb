import{u as T,e as I,k as S,j as e,A as L,C as k,l as $}from"./index-d63ee538.js";import{r as t}from"./vendor-021dee49.js";import{A as U}from"./SkeletonLoading-3b438a19.js";import{u as D}from"./router-3052588b.js";import{C as b}from"./ChartBarIcon-d2682d5e.js";import{C as R}from"./ClockIcon-d6d0aaad.js";import{E as F}from"./ExclamationTriangleIcon-2a54ccc6.js";import{G as M}from"./GlobeAltIcon-f8e2b057.js";import{E as P}from"./EyeIcon-6ff4a41f.js";import"./utils-917b1704.js";function B({title:r,titleId:a,...d},o){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},d),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"}))}const O=t.forwardRef(B),G=O;function W({title:r,titleId:a,...d},o){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},d),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const H=t.forwardRef(W),Z=H;function V({title:r,titleId:a,...d},o){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},d),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const z=t.forwardRef(V),J=z;function K({title:r,titleId:a,...d},o){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},d),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15a4.5 4.5 0 0 0 4.5 4.5H18a3.75 3.75 0 0 0 1.332-7.257 3 3 0 0 0-3.758-3.848 5.25 5.25 0 0 0-10.233 2.33A4.502 4.502 0 0 0 2.25 15Z"}))}const Q=t.forwardRef(K),q=Q;function X({title:r,titleId:a,...d},o){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},d),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Y=t.forwardRef(X),f=Y;function ee({title:r,titleId:a,...d},o){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},d),r?t.createElement("title",{id:a},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const se=t.forwardRef(ee),te=se,ue=()=>{const r=D(),{user:a}=T(),[d,o]=t.useState(!0),[c,C]=t.useState("7"),[l,j]=t.useState({total:{totalRequests:0,totalCost:0,successfulRequests:0,failedRequests:0,avgResponseTime:0},byApiType:[],dailyUsage:[]}),[v,ae]=t.useState({places_text_search:.032,places_details:.017,places_photos:.007,places_autocomplete:.00285});t.useEffect(()=>{if((a==null?void 0:a.role)!=="admin"){I.error("Access denied. Admin privileges required."),r("/dashboard");return}_()},[a,r,c]);const _=async()=>{try{o(!0);const s=new Date,n=new Date;n.setDate(n.getDate()-parseInt(c));const m=await S.get("/admin/api-usage",{params:{startDate:n.toISOString(),endDate:s.toISOString(),days:c}});j(m.data)}catch(s){console.error("Error loading API usage data:",s),j({total:{totalRequests:1247,totalCost:39.9,successfulRequests:1198,failedRequests:49,avgResponseTime:892},byApiType:[{_id:"places_text_search",totalRequests:1180,totalCost:37.76,successfulRequests:1140,failedRequests:40,avgResponseTime:920},{_id:"places_details",totalRequests:45,totalCost:.77,successfulRequests:42,failedRequests:3,avgResponseTime:680},{_id:"places_photos",totalRequests:22,totalCost:.15,successfulRequests:16,failedRequests:6,avgResponseTime:1150}],dailyUsage:[{_id:{year:2024,month:12,day:15},totalRequests:89,totalCost:2.85,successfulRequests:85},{_id:{year:2024,month:12,day:16},totalRequests:124,totalCost:3.97,successfulRequests:118},{_id:{year:2024,month:12,day:17},totalRequests:156,totalCost:4.99,successfulRequests:151},{_id:{year:2024,month:12,day:18},totalRequests:203,totalCost:6.5,successfulRequests:195},{_id:{year:2024,month:12,day:19},totalRequests:178,totalCost:5.7,successfulRequests:170},{_id:{year:2024,month:12,day:20},totalRequests:234,totalCost:7.49,successfulRequests:224},{_id:{year:2024,month:12,day:21},totalRequests:263,totalCost:8.4,successfulRequests:255}]})}finally{o(!1)}},w=()=>{const s=l.total.totalRequests,n=l.total.successfulRequests;return s>0?(n/s*100).toFixed(1):0},N=s=>({places_text_search:"Places Search",places_details:"Place Details",places_photos:"Place Photos",places_autocomplete:"Autocomplete"})[s]||s,A=s=>({places_text_search:e.jsx(M,{className:"h-5 w-5"}),places_details:e.jsx(P,{className:"h-5 w-5"}),places_photos:e.jsx(te,{className:"h-5 w-5"}),places_autocomplete:e.jsx(J,{className:"h-5 w-5"})})[s]||e.jsx(b,{className:"h-5 w-5"}),i=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:4}).format(s),h=s=>s<1e3?`${Math.round(s)}ms`:`${(s/1e3).toFixed(1)}s`,E=()=>l.total.totalCost/parseInt(c)*30,x=()=>{if(l.dailyUsage.length<2)return"stable";const s=l.dailyUsage.slice(-3),n=l.dailyUsage.slice(-6,-3),m=s.reduce((p,y)=>p+y.totalRequests,0)/s.length,g=n.reduce((p,y)=>p+y.totalRequests,0)/n.length,u=(m-g)/g*100;return u>10?"increasing":u<-10?"decreasing":"stable"};return d?e.jsx(U,{}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-lg mx-auto lg:max-w-7xl",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 dark:from-blue-700 dark:via-purple-700 dark:to-indigo-800 mx-2 sm:mx-4 mt-2 sm:mt-4 rounded-2xl sm:rounded-3xl p-4 sm:p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("button",{onClick:()=>r("/admin"),className:"mr-3 p-2 bg-white bg-opacity-20 rounded-xl hover:bg-opacity-30 transition-colors",children:e.jsx(L,{className:"h-4 sm:h-5 w-4 sm:w-5"})}),e.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:"API Usage Monitor ðŸ“Š"})]}),e.jsx("p",{className:"text-blue-100 dark:text-blue-200 text-sm",children:"Google Places API Usage & Cost Tracking"})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"bg-white bg-opacity-20 rounded-2xl p-3",children:e.jsx(b,{className:"h-8 sm:h-12 w-8 sm:w-12 text-yellow-300"})})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:["7","30","90"].map(s=>e.jsxs("button",{onClick:()=>C(s),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${c===s?"bg-white text-blue-600":"bg-white bg-opacity-20 text-white hover:bg-opacity-30"}`,children:["Last ",s," days"]},s))}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 text-blue-100 dark:text-blue-200 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[l.total.totalRequests," Requests"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:i(l.total.totalCost)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[w(),"% Success"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:h(l.total.avgResponseTime)})]})]})]}),e.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl p-4 sm:p-6 border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(f,{className:"h-8 w-8 text-green-500"}),e.jsx("div",{className:`p-2 rounded-full text-xs ${x()==="increasing"?"bg-red-100 text-red-600":x()==="decreasing"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"}`,children:x()==="increasing"?e.jsx(Z,{className:"h-3 w-3"}):x()==="decreasing"?e.jsx(G,{className:"h-3 w-3"}):e.jsx("span",{children:"="})})]}),e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-1",children:i(l.total.totalCost)}),e.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:["Total Cost (",c," days)"]}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["Monthly Est: ",i(E())]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl p-4 sm:p-6 border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(q,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(l.total.totalRequests/parseInt(c)).toFixed(0),"/day"]})]}),e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-1",children:l.total.totalRequests.toLocaleString()}),e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:"Total Requests"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl p-4 sm:p-6 border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(k,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{className:"text-xs text-red-500",children:[l.total.failedRequests," failures"]})]}),e.jsxs("div",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-1",children:[w(),"%"]}),e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:"Success Rate"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl p-4 sm:p-6 border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(R,{className:"h-8 w-8 text-purple-500"}),e.jsx("div",{className:`text-xs ${l.total.avgResponseTime>1e3?"text-red-500":l.total.avgResponseTime>500?"text-yellow-500":"text-green-500"}`,children:l.total.avgResponseTime>1e3?"Slow":l.total.avgResponseTime>500?"Fair":"Good"})]}),e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-1",children:h(l.total.avgResponseTime)}),e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:"Avg Response Time"})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl border border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(b,{className:"h-5 w-5 text-purple-500 mr-2"}),"API Breakdown"]}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:l.byApiType.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 sm:p-4 bg-gray-50 dark:bg-gray-700 rounded-xl sm:rounded-2xl",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2 sm:mb-0",children:[e.jsx("div",{className:"p-2 bg-white dark:bg-gray-600 rounded-lg",children:A(s._id)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm sm:text-base font-medium text-gray-900 dark:text-white",children:N(s._id)}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[i(v[s._id])," per request"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:items-center sm:space-x-6 gap-2 text-sm",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:s.totalRequests.toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Requests"})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:i(s.totalCost)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Cost"})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsxs("div",{className:"font-medium text-gray-900 dark:text-white",children:[(s.successfulRequests/s.totalRequests*100).toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Success"})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:h(s.avgResponseTime)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Avg Time"})]})]})]},s._id))})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl border border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx($,{className:"h-5 w-5 text-blue-500 mr-2"}),"Daily Usage Trend"]}),e.jsx("div",{className:"space-y-3",children:l.dailyUsage.map(s=>{const n=new Date(s._id.year,s._id.month-1,s._id.day),m=Math.max(...l.dailyUsage.map(u=>u.totalRequests)),g=s.totalRequests/m*100;return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-16 sm:w-20 text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:n.toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-600 rounded-full h-3 sm:h-4",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-3 sm:h-4 rounded-full transition-all duration-300",style:{width:`${g}%`}})}),e.jsx("div",{className:"w-16 sm:w-20 text-xs sm:text-sm text-gray-900 dark:text-white text-right",children:s.totalRequests}),e.jsx("div",{className:"w-16 sm:w-20 text-xs sm:text-sm text-gray-500 dark:text-gray-400 text-right",children:i(s.totalCost)})]},`${s._id.year}-${s._id.month}-${s._id.day}`)})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl border border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(f,{className:"h-5 w-5 text-green-500 mr-2"}),"Current Google Places API Pricing"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Object.entries(v).map(([s,n])=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N(s)}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[i(n)," per request"]})]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[i(n*1e3)," per 1,000 requests"]})]},s))}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(F,{className:"h-5 w-5 text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-900 dark:text-blue-300",children:"Google Cloud Free Tier"}),e.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-400 mt-1",children:"$200 in free credits for the first 90 days. After that, you'll be charged based on usage."})]})]})})]})})]})]})})};export{ue as default};
