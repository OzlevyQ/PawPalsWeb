import{u as M,k as i,e as c,j as e,i as j,y as w,r as _,z as H,B as G,H as F,C as Z}from"./index-d63ee538.js";import{r as l}from"./vendor-021dee49.js";import{A as B}from"./SkeletonLoading-3b438a19.js";import{u as L}from"./router-3052588b.js";import{C as v}from"./ChartBarIcon-d2682d5e.js";import{C as O}from"./CogIcon-57d60756.js";import{E as N}from"./EyeIcon-6ff4a41f.js";import{X as T}from"./XCircleIcon-3fe8bf8c.js";import{P as D}from"./PencilSquareIcon-ae0df1ee.js";import"./utils-917b1704.js";function W({title:t,titleId:d,...m},x){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:x,"aria-labelledby":d},m),t?l.createElement("title",{id:d},t):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const X=l.forwardRef(W),z=X;function J({title:t,titleId:d,...m},x){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:x,"aria-labelledby":d},m),t?l.createElement("title",{id:d},t):null,l.createElement("path",{d:"M18.375 2.25c-1.035 0-1.875.84-1.875 1.875v15.75c0 1.035.84 1.875 1.875 1.875h.75c1.035 0 1.875-.84 1.875-1.875V4.125c0-1.036-.84-1.875-1.875-1.875h-.75ZM9.75 8.625c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-.75a1.875 1.875 0 0 1-1.875-1.875V8.625ZM3 13.125c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v6.75c0 1.035-.84 1.875-1.875 1.875h-.75A1.875 1.875 0 0 1 3 19.875v-6.75Z"}))}const Y=l.forwardRef(J),K=Y,ie=()=>{const{user:t}=M(),d=L(),[m,x]=l.useState([]),[p,k]=l.useState([]),[n,C]=l.useState({totalUsers:0,totalGardens:0,activeVisits:0,totalDogs:0}),[b,S]=l.useState({totalRequests:0,totalCost:0,successRate:0}),[U,A]=l.useState(""),[R,I]=l.useState("");l.useState(!1),l.useState(!1);const[E,y]=l.useState(!0);l.useEffect(()=>{console.log("ðŸ” AdminDashboard - Current user:",t),console.log("ðŸ” AdminDashboard - User role:",t==null?void 0:t.role),console.log("ðŸ” AdminDashboard - Token exists:",!!localStorage.getItem("token")),h()},[]);const h=async()=>{var s,a;try{y(!0),console.log("ðŸ” Starting loadAdminData..."),console.log("ðŸ” User role before API calls:",t==null?void 0:t.role);const[r,o,u,$]=await Promise.all([i.get("/admin/users"),i.get("/admin/gardens"),i.get("/admin/stats"),i.get("/admin/api-usage?days=7").catch(()=>({data:{total:{totalRequests:0,totalCost:0,successfulRequests:0}}}))]);x(r.data||[]),k(o.data||[]),C(u.data||{totalUsers:0,totalGardens:0,activeVisits:0,totalDogs:0});const g=$.data.total||{totalRequests:0,totalCost:0,successfulRequests:0};S({totalRequests:g.totalRequests,totalCost:g.totalCost,successRate:g.totalRequests>0?(g.successfulRequests/g.totalRequests*100).toFixed(1):0})}catch(r){console.error("ðŸ” Error loading admin data:",r),console.error("ðŸ” Error response:",r.response),console.error("ðŸ” Error status:",(s=r.response)==null?void 0:s.status),console.error("ðŸ” Error data:",(a=r.response)==null?void 0:a.data),c.error("Failed to load admin data")}finally{y(!1)}},q=async(s,a)=>{try{await i.put(`/users/${s}/role`,{role:a}),c.success("User role updated successfully"),h()}catch{c.error("Failed to update user role")}},f=async()=>{var s,a;try{console.log("ðŸ” Attempting to upgrade to admin...");const r=await i.post("/auth/make-admin");console.log("ðŸ” Upgrade response:",r.data);const o=r.data.user;localStorage.setItem("user",JSON.stringify(o)),c.success("Upgraded to admin successfully! Please refresh the page."),window.location.reload()}catch(r){console.error("ðŸ” Error upgrading to admin:",r),c.error("Failed to upgrade to admin: "+(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||r.message))}},P=async(s,a)=>{const r=a==="active"?"suspended":"active";try{await i.put(`/users/${s}/status`,{status:r}),c.success(`User ${r==="active"?"activated":"suspended"} successfully`),h()}catch{c.error("Failed to update user status")}},V=s=>{const a={admin:{color:"text-red-700",bg:"bg-red-100",label:"ðŸ‘‘ Admin"},garden_manager:{color:"text-blue-700",bg:"bg-blue-100",label:"ðŸ¢ Manager"},dog_owner:{color:"text-green-700",bg:"bg-green-100",label:"ðŸ• Owner"}};return a[s]||a.dog_owner};return E?e.jsx(B,{}):(t==null?void 0:t.role)!=="admin"&&n.totalUsers===0?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl p-8 text-center max-w-md border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ”’"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Admin Access Required"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You need admin privileges to access this page."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Current role: ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.role)||"Unknown"})]}),e.jsx("button",{onClick:f,className:"w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-6 rounded-xl transition-colors",children:"ðŸš€ Upgrade to Admin (Development)"}),e.jsx("p",{className:"text-xs text-gray-400",children:"This is a temporary development feature"})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-lg mx-auto lg:max-w-7xl px-1 sm:px-0",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 via-pink-600 to-red-600 dark:from-purple-700 dark:via-pink-700 dark:to-red-700 mx-2 sm:mx-4 mt-2 sm:mt-4 rounded-2xl sm:rounded-3xl p-4 sm:p-6 text-white",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-1",children:"Admin Center ðŸ›¡ï¸"}),e.jsxs("p",{className:"text-purple-100 dark:text-purple-200 text-xs sm:text-sm mb-3",children:["Welcome back, ",t==null?void 0:t.firstName,"! Manage the Pawradise community"]}),e.jsxs("div",{className:"bg-white bg-opacity-20 rounded-xl p-3 mb-3",children:[e.jsxs("div",{className:"text-xs text-purple-100",children:[e.jsxs("div",{children:["User Role: ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.role)||"Unknown"})]}),e.jsxs("div",{children:["User ID: ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t._id)||"Unknown"})]}),e.jsxs("div",{children:["Token: ",e.jsx("span",{className:"font-medium",children:localStorage.getItem("token")?"Present":"Missing"})]})]}),(t==null?void 0:t.role)!=="admin"&&e.jsx("button",{onClick:f,className:"mt-2 bg-yellow-500 hover:bg-yellow-600 text-yellow-900 font-medium py-1 px-3 rounded-lg text-xs transition-colors",children:"ðŸš€ Upgrade to Admin"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-purple-100 dark:text-purple-200 text-xs sm:text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"h-3 sm:h-4 w-3 sm:w-4 mr-1"}),e.jsxs("span",{children:[n.totalUsers," Users"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"h-3 sm:h-4 w-3 sm:w-4 mr-1"}),e.jsxs("span",{children:[n.totalGardens," Parks"]})]})]})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"bg-white bg-opacity-20 rounded-2xl p-3",children:e.jsx(_,{className:"h-8 sm:h-12 w-8 sm:w-12 text-yellow-300"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:()=>d("/admin/requests"),className:"bg-white bg-opacity-20 rounded-xl sm:rounded-2xl p-3 hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(z,{className:"h-4 sm:h-5 w-4 sm:w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Review Requests"})]}),e.jsxs("button",{onClick:()=>d("/admin/api-usage"),className:"bg-white bg-opacity-20 rounded-xl sm:rounded-2xl p-3 hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(v,{className:"h-4 sm:h-5 w-4 sm:w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"API Usage"})]}),e.jsxs("button",{onClick:()=>d("/admin/settings"),className:"bg-white bg-opacity-20 rounded-xl sm:rounded-2xl p-3 hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx(O,{className:"h-4 sm:h-5 w-4 sm:w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Settings"})]})]})]}),e.jsxs("div",{className:"px-2 sm:px-4 py-4 sm:py-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl p-3 sm:p-4 text-center border border-gray-100 dark:border-gray-700",children:[e.jsx(H,{className:"w-6 sm:w-8 h-6 sm:h-8 text-blue-500 mx-auto mb-2"}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white",children:n.totalUsers}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total Users"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl p-3 sm:p-4 text-center border border-gray-100 dark:border-gray-700",children:[e.jsx(G,{className:"w-6 sm:w-8 h-6 sm:h-8 text-green-500 mx-auto mb-2"}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white",children:n.totalGardens}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Dog Parks"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl p-3 sm:p-4 text-center border border-gray-100 dark:border-gray-700",children:[e.jsx(K,{className:"w-6 sm:w-8 h-6 sm:h-8 text-yellow-500 mx-auto mb-2"}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white",children:n.activeVisits}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Active Visits"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl p-3 sm:p-4 text-center border border-gray-100 dark:border-gray-700",children:[e.jsx(F,{className:"w-6 sm:w-8 h-6 sm:h-8 text-pink-500 mx-auto mb-2"}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white",children:n.totalDogs}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Happy Dogs"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl p-3 sm:p-4 text-center border border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",onClick:()=>d("/admin/api-usage"),children:[e.jsx(v,{className:"w-6 sm:w-8 h-6 sm:h-8 text-purple-500 mx-auto mb-2"}),e.jsxs("div",{className:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white",children:["$",b.totalCost.toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"API Cost (7d)"}),e.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[b.successRate,"% success"]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl border border-gray-100 dark:border-gray-700 mb-4 sm:mb-6",children:e.jsxs("div",{className:"p-3 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(j,{className:"h-4 sm:h-5 w-4 sm:w-5 text-blue-500 mr-2"}),"User Management"]}),e.jsxs("span",{className:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 text-xs font-medium px-2 py-1 rounded-full self-start sm:self-auto",children:[m.length," users"]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search users...",value:U,onChange:s=>A(s.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-200 dark:border-gray-600 rounded-xl sm:rounded-2xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})}),e.jsx("div",{className:"space-y-3",children:m.slice(0,5).map(s=>{var r,o;const a=V(s.role);return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-xl sm:rounded-2xl space-y-2 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"w-8 sm:w-10 h-8 sm:h-10 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white font-medium text-xs sm:text-sm flex-shrink-0",children:[(r=s.firstName)==null?void 0:r.charAt(0),(o=s.lastName)==null?void 0:o.charAt(0)]}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"text-sm sm:text-base font-medium text-gray-900 dark:text-white truncate",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center justify-between sm:justify-end space-x-2 w-full sm:w-auto",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${a.bg} ${a.color} flex-shrink-0`,children:a.label}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:s.role,onChange:u=>q(s._id,u.target.value),className:"text-xs border border-gray-200 dark:border-gray-600 rounded-lg px-2 py-1 bg-white dark:bg-gray-600 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"dog_owner",children:"ðŸ• Owner"}),e.jsx("option",{value:"garden_manager",children:"ðŸ¢ Manager"}),e.jsx("option",{value:"admin",children:"ðŸ‘‘ Admin"})]}),e.jsx("button",{onClick:()=>d(`/profile?userId=${s._id}`),className:"p-1.5 text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:"View Profile",children:e.jsx(N,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>P(s._id,s.status),className:`p-1.5 transition-colors ${s.status==="active"?"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300":"text-green-500 hover:text-green-700 dark:text-green-400 dark:hover:text-green-300"}`,title:s.status==="active"?"Suspend User":"Activate User",children:s.status==="active"?e.jsx(T,{className:"h-4 w-4"}):e.jsx(Z,{className:"h-4 w-4"})})]})]})]},s._id)})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl border border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"p-3 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(w,{className:"h-4 sm:h-5 w-4 sm:w-5 text-green-500 mr-2"}),"Garden Management"]}),e.jsxs("span",{className:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 text-xs font-medium px-2 py-1 rounded-full self-start sm:self-auto",children:[p.length," gardens"]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search gardens...",value:R,onChange:s=>I(s.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-200 dark:border-gray-600 rounded-xl sm:rounded-2xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm"})}),e.jsx("div",{className:"space-y-3",children:p.slice(0,5).map(s=>{var a,r;return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-xl sm:rounded-2xl space-y-2 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 sm:w-10 h-8 sm:h-10 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center text-white font-medium text-xs sm:text-sm flex-shrink-0",children:(a=s.name)==null?void 0:a.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm sm:text-base font-medium text-gray-900 dark:text-white truncate",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:(r=s.location)==null?void 0:r.address})]})]}),e.jsxs("div",{className:"flex items-center justify-between sm:justify-end space-x-2 w-full sm:w-auto",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${s.type==="public"?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"} flex-shrink-0`,children:s.type==="public"?"ðŸŒ Public":"ðŸ¢ Private"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>d(`/garden/${s._id}`),className:"p-1.5 text-green-500 hover:text-green-700 dark:text-green-400 dark:hover:text-green-300 transition-colors",title:"View Garden",children:e.jsx(N,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>d(`/garden-manager?edit=${s._id}`),className:"p-1.5 text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:"Edit Garden",children:e.jsx(D,{className:"h-4 w-4"})})]})]})]},s._id)})})]})})]})]})})};export{ie as default};
