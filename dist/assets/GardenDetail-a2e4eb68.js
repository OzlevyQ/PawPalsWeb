import{u as F,j as e,i as V,k as $,e as p,d as ce,v as _,A,M as E,F as de,U as oe,c as z,b as Q,C as me}from"./index-d63ee538.js";import{r as n}from"./vendor-021dee49.js";import{gardenService as R}from"./gardenService-8e5619dd.js";import{a as xe}from"./SkeletonLoading-3b438a19.js";import{L as he,b as ge,u as ue}from"./router-3052588b.js";import{f as be,S as pe}from"./StartChatButton-0f462bef.js";import{C as Z}from"./ClockIcon-d6d0aaad.js";import{S as q}from"./StarIcon-7759d6c0.js";import{Q as fe}from"./QRCodeGenerator-4098bf1e.js";import{B as ye}from"./BellIcon-587118bd.js";import{B as G}from"./BellIcon-d89f06db.js";import{C as je}from"./CheckCircleIcon-ad35d564.js";import{E as J}from"./EnvelopeIcon-88013258.js";import{C as Ne}from"./ChatBubbleBottomCenterTextIcon-6ed762d8.js";import{P as we}from"./PhoneIcon-ccc078a9.js";import"./utils-917b1704.js";import"./ChatBubbleLeftIcon-5a8a0035.js";import"./CheckIcon-3891f6eb.js";import"./ShareIcon-8f4ee12b.js";import"./ArrowPathIcon-a9aaab64.js";function ve({title:t,titleId:a,...m},i){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":a},m),t?n.createElement("title",{id:a},t):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H14.25M5.904 18.5c.083.205.173.405.27.602.197.4-.078.898-.523.898h-.908c-.889 0-1.713-.518-1.972-1.368a12 12 0 0 1-.521-3.507c0-1.553.295-3.036.831-4.398C3.387 9.953 4.167 9.5 5 9.5h1.053c.472 0 .745.556.5.96a8.958 8.958 0 0 0-1.302 4.665c0 1.194.232 2.333.654 3.375Z"}))}const ke=n.forwardRef(ve),Se=ke;function Ce({title:t,titleId:a,...m},i){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":a},m),t?n.createElement("title",{id:a},t):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const Ie=n.forwardRef(Ce),Y=Ie,K=n.forwardRef(({gardenId:t},a)=>{const{isAuthenticated:m,user:i}=F(),[r,g]=n.useState([]),[u,N]=n.useState({}),[f,C]=n.useState(!1);n.useEffect(()=>{j();const d=setInterval(j,12e4);return()=>clearInterval(d)},[t]);const j=async()=>{try{C(!0);const d=await R.getCurrentVisitors(t);if(g(d.visitors),m&&i&&d.visitors.length>0){const l={};await Promise.all(d.visitors.map(async b=>{if(b.user._id!==i._id)try{const c=await be.getFriendshipStatus(b.user._id);l[b.user._id]=c}catch(c){console.error("Error loading friendship status:",c),l[b.user._id]=null}})),N(l)}}catch(d){console.error("Error loading visitors:",d),g([])}finally{C(!1)}};n.useImperativeHandle(a,()=>({refresh:j}));const x=d=>{const l=Math.floor((Date.now()-new Date(d).getTime())/6e4);return l<60?`${l}m ago`:`${Math.floor(l/60)}h ${l%60}m ago`},w=d=>{if(!m||!i||d._id===i._id)return!1;const l=u[d._id];return(l==null?void 0:l.status)==="accepted"};return f?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(V,{className:"h-5 w-5 mr-2 text-purple-500"}),"Currently in the Park"]})}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Loading visitors..."})]})]})}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(V,{className:"h-5 w-5 mr-2 text-purple-500"}),"Currently in the Park (",r.length,")"]})}),r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🏞️"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No one is currently in the park"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Be the first to check in!"})]}):e.jsx("div",{className:"space-y-4",children:r.map(d=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-2xl p-4 border border-gray-100 dark:border-gray-600",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:d.user.profileImage?e.jsx("img",{className:"h-12 w-12 rounded-full object-cover border-2 border-white dark:border-gray-600 shadow-sm",src:d.user.profileImage,alt:""}):e.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center border-2 border-white dark:border-gray-600 shadow-sm",children:e.jsx("span",{className:"text-white font-bold text-lg",children:d.user.firstName[0]})})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("p",{className:"text-sm font-bold text-gray-900 dark:text-white",children:[d.user.firstName," ",d.user.lastName]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),"Arrived ",x(d.checkInTime)]})]})]}),d.dogs.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300 mb-3",children:"With dogs:"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:d.dogs.map(l=>e.jsxs(he,{to:`/dogs/profile/${l._id}`,className:"flex items-center space-x-3 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 hover:from-blue-100 hover:to-indigo-100 dark:hover:from-blue-900/30 dark:hover:to-indigo-900/30 border border-blue-200 dark:border-blue-700 rounded-xl p-3 transition-all duration-200 hover:shadow-md group",children:[e.jsxs("div",{className:"flex-shrink-0 relative",children:[l.image||l.gallery&&l.gallery.length>0?e.jsx("img",{className:"h-12 w-12 rounded-full object-cover border-2 border-white dark:border-gray-600 shadow-sm group-hover:scale-105 transition-transform duration-200",src:l.image||l.gallery[0],alt:l.name,onError:b=>{b.target.style.display="none",b.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:`h-12 w-12 rounded-full bg-gradient-to-br from-orange-100 to-amber-100 dark:from-orange-900/50 dark:to-amber-900/50 border-2 border-white dark:border-gray-600 shadow-sm flex items-center justify-center group-hover:scale-105 transition-transform duration-200 ${l.image||l.gallery&&l.gallery.length>0?"hidden":"flex"}`,children:e.jsx("span",{className:"text-xl",children:"🐕"})}),e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 bg-green-400 border-2 border-white dark:border-gray-600 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-pulse"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate group-hover:text-blue-700 dark:group-hover:text-blue-300 transition-colors",children:l.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[l.breed," • ",l.size,l.age&&` • ${l.age} months`]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"})})]},l._id))})]})]}),w(d.user)&&e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx(pe,{targetUser:d.user,size:"sm",className:"mt-2"})})]})},d._id))})]})})});K.displayName="CurrentVisitors";const Re=n.memo(K),L={async createReview(t){return(await $.post("/reviews",t)).data},async getGardenReviews(t,a={}){return(await $.get(`/reviews/garden/${t}`,{params:a})).data},async updateReview(t,a){return(await $.put(`/reviews/${t}`,a)).data},async deleteReview(t){return(await $.delete(`/reviews/${t}`)).data},async markHelpful(t){return(await $.post(`/reviews/${t}/helpful`)).data}},$e=({gardenId:t,canReview:a=!1,visitId:m=null})=>{const{user:i,isAuthenticated:r}=F(),[g,u]=n.useState([]),[N,f]=n.useState(!0),[C,j]=n.useState(!1),[x,w]=n.useState({rating:{overall:5,cleanliness:5,safety:5,amenities:5,accessibility:5},review:""});n.useEffect(()=>{d()},[t]);const d=async()=>{try{f(!0);const s=await L.getGardenReviews(t);u(s.reviews)}catch(s){console.error("Error loading reviews:",s),u([])}finally{f(!1)}},l=async s=>{var h,S;if(s.preventDefault(),!r){p.info("Please log in to write a review");return}if(!m){p.error("You can only review after a visit");return}try{await L.createReview({gardenId:t,visitId:m,...x}),p.success("Review submitted successfully!"),j(!1),d()}catch(v){console.error("Error submitting review:",v),p.error(((S=(h=v.response)==null?void 0:h.data)==null?void 0:S.error)||"Failed to submit review")}},b=async s=>{if(!r){p.info("Please log in to mark reviews as helpful");return}try{const h=await L.markHelpful(s);p.success("Feedback recorded"),u(g.map(S=>S._id===s?{...S,helpful:h.helpfulCount}:S))}catch(h){console.error("Error marking helpful:",h)}},c=({value:s,onChange:h=null,size:S="sm"})=>e.jsxs("div",{className:"flex items-center",children:[[1,2,3,4,5].map(v=>e.jsx("button",{type:"button",onClick:()=>h&&h(v),className:`${h?"cursor-pointer":"cursor-default"} ${S==="sm"?"text-lg":"text-2xl"}`,disabled:!h,children:e.jsx(q,{className:`${S==="sm"?"h-5 w-5":"h-6 w-6"} ${v<=s?"text-yellow-400":"text-gray-300"}`})},v)),e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:[s,"/5"]})]});return e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Reviews"}),a&&!C&&e.jsx("button",{onClick:()=>j(!0),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Write a Review"})]}),r&&!a&&e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"text-blue-400 text-xl",children:"ℹ️"})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Want to write a review?"})," You can review this garden after completing a visit. Check in with your dogs and complete your visit to share your experience!"]})})]})}),!r&&e.jsx("div",{className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"text-gray-400 text-xl",children:"👤"})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Want to write a review?"})," Please log in and complete a visit to this garden first."]})})]})}),C&&e.jsxs("form",{onSubmit:l,className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Share Your Experience"}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Overall Rating"}),e.jsx(c,{value:x.rating.overall,onChange:s=>w({...x,rating:{...x.rating,overall:s}}),size:"md"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600",children:"Cleanliness"}),e.jsx(c,{value:x.rating.cleanliness,onChange:s=>w({...x,rating:{...x.rating,cleanliness:s}})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600",children:"Safety"}),e.jsx(c,{value:x.rating.safety,onChange:s=>w({...x,rating:{...x.rating,safety:s}})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600",children:"Amenities"}),e.jsx(c,{value:x.rating.amenities,onChange:s=>w({...x,rating:{...x.rating,amenities:s}})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600",children:"Accessibility"}),e.jsx(c,{value:x.rating.accessibility,onChange:s=>w({...x,rating:{...x.rating,accessibility:s}})})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"review",className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Review"}),e.jsx("textarea",{id:"review",rows:4,value:x.review,onChange:s=>w({...x,review:s.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"Share your experience...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>j(!1),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),e.jsx("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Submit Review"})]})]}),N?e.jsx("div",{className:"text-center py-4",children:"Loading reviews..."}):g.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No reviews yet. Be the first to review!"}):e.jsx("div",{className:"space-y-6",children:g.map(s=>{var h;return e.jsxs("div",{className:"border-b pb-6 last:border-b-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start",children:[s.user.profileImage?e.jsx("img",{className:"h-10 w-10 rounded-full",src:s.user.profileImage,alt:""}):e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-600 text-sm",children:s.user.firstName[0]})}),e.jsxs("div",{className:"ml-3",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[s.user.firstName," ",s.user.lastName]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt).toLocaleDateString()})]})]}),e.jsx(c,{value:s.rating.overall})]}),e.jsx("div",{className:"mt-3 text-sm text-gray-700",children:e.jsx("p",{children:s.review})}),s.rating.cleanliness&&e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Cleanliness:"}),e.jsxs("span",{className:"font-medium",children:[s.rating.cleanliness,"/5"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Safety:"}),e.jsxs("span",{className:"font-medium",children:[s.rating.safety,"/5"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Amenities:"}),e.jsxs("span",{className:"font-medium",children:[s.rating.amenities,"/5"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Accessibility:"}),e.jsxs("span",{className:"font-medium",children:[s.rating.accessibility,"/5"]})]})]}),e.jsx("div",{className:"mt-4 flex items-center",children:e.jsxs("button",{onClick:()=>b(s._id),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(Se,{className:"h-4 w-4 mr-1"}),"Helpful (",((h=s.helpful)==null?void 0:h.length)||0,")"]})})]},s._id)})})]})})},es=()=>{var M,W,O;const{id:t}=ge(),a=ue(),{user:m,isAuthenticated:i}=F(),[r,g]=n.useState(null),[u,N]=n.useState([]),[f,C]=n.useState(null),[j,x]=n.useState([]),[w,d]=n.useState(!0),[l,b]=n.useState(!1),[c,s]=n.useState([]),[h,S]=n.useState("details"),[v,H]=n.useState("garden"),[X,D]=n.useState(!1),T=n.useRef();n.useEffect(()=>{B()},[t,i]);const B=async()=>{try{d(!0);const o=await R.getGardenById(t);if(g(o),i){const[y,k,I]=await Promise.all([ce.getMyDogs(),_.getActiveVisit(),_.getMyVisits()]);N(y.dogs||y||[]),C(k.visit||k),x(I.visits||I||[]),ee()}}catch(o){console.error("Error loading garden data:",o),p.error("Failed to load garden details."),a("/gardens")}finally{d(!1)}},ee=async()=>{try{const o=await R.getNewsletterStatus(t);D(o.isSubscribed)}catch(o){console.warn("Newsletter status check failed:",o.message),D(!1)}},se=()=>{if(!i){p.info("Please log in to manage newsletter subscriptions.");return}H("newsletter")},U=()=>{H("garden")},re=o=>{D(o)},te=async()=>{var o,y,k;if(!(!i||c.length===0)){b(!0);try{await _.checkIn({gardenId:t,dogIds:c}),p.success("Checked in successfully!"),s([]),await B(),(o=T.current)==null||o.refresh()}catch(I){p.error(((k=(y=I.response)==null?void 0:y.data)==null?void 0:k.error)||"Failed to check in.")}finally{b(!1)}}},ae=o=>{s(y=>y.includes(o)?y.filter(k=>k!==o):[...y,o])},ie=()=>{if(!(r!=null&&r.openingHours))return!1;const o=new Date,y=o.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase(),k=r.openingHours[y];if(!k||k.closed)return!1;const I=o.toTimeString().slice(0,5);return I>=k.open&&I<=k.close};if(w)return e.jsx(xe,{});if(!r)return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex justify-center items-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg p-12 text-center border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🏞️"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Garden Not Found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"The garden you're looking for doesn't exist."}),e.jsxs("button",{onClick:()=>a("/gardens"),className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-medium rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-200 transform hover:scale-105",children:[e.jsx(A,{className:"h-5 w-5 mr-2"}),"Back to Gardens"]})]})});const P=ie(),ne=[{id:"details",name:"Details",icon:E},{id:"amenities",name:"Amenities",icon:Q},{id:"reviews",name:"Reviews",icon:Ne}],le=()=>{switch(h){case"amenities":return e.jsx(Fe,{amenities:r.amenities});case"reviews":const o=j.find(y=>y.garden===t&&y.status==="completed");return e.jsx($e,{gardenId:t,canReview:i&&!!o,visitId:o==null?void 0:o._id});case"details":default:return e.jsx(Ee,{garden:r})}};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsxs("div",{className:`bg-gradient-to-br ${r.type==="public"?"from-green-600 via-emerald-600 to-teal-700 dark:from-green-700 dark:via-emerald-700 dark:to-teal-800":"from-purple-600 via-pink-600 to-indigo-700 dark:from-purple-700 dark:via-pink-700 dark:to-indigo-800"} mx-4 mt-4 rounded-3xl p-6 text-white relative overflow-hidden`,children:[e.jsx("div",{className:"absolute -top-6 -right-6 opacity-20",children:e.jsx("div",{className:"text-8xl",children:r.type==="public"?"🌳":"🏢"})}),e.jsxs("div",{className:"relative z-10",children:[v==="newsletter"?e.jsxs("button",{onClick:U,className:"flex items-center text-white/80 hover:text-white transition-colors mb-4 p-2 rounded-xl bg-white/20 hover:bg-white/30",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Back to Garden"]}):e.jsxs("button",{onClick:()=>a("/gardens"),className:"flex items-center text-white/80 hover:text-white transition-colors mb-4 p-2 rounded-xl bg-white/20 hover:bg-white/30",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Back to Gardens"]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"bg-white/20 px-3 py-1 rounded-full text-sm",children:r.type==="public"?"🌍 Public":"🔒 Private"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${P?"bg-green-500/20 text-green-100":"bg-red-500/20 text-red-100"}`,children:P?"🟢 Open":"🔴 Closed"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold flex-1",children:v==="newsletter"?"Newsletter Subscription":r.name}),v==="garden"&&e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:se,className:"p-2 bg-white/20 rounded-full hover:bg-white/30 transition-all",title:"Newsletter subscription",children:X?e.jsx(ye,{className:"h-5 w-5 text-blue-400"}):e.jsx(G,{className:"h-5 w-5 text-white/80"})})})]}),e.jsx("p",{className:"text-white/90 text-sm mb-4 line-clamp-2",children:v==="newsletter"?`Manage your email notifications for ${r.name}`:r.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),((M=r.location)==null?void 0:M.city)||"Location"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),r.currentOccupancy||0," / ",((W=r.capacity)==null?void 0:W.maxDogs)||"No limit"]}),((O=r.statistics)==null?void 0:O.averageRating)>0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"h-4 w-4 mr-2 text-yellow-400"}),r.statistics.averageRating.toFixed(1)," (",r.statistics.totalReviews,")"]})]})]})]})]}),v==="garden"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-4 mt-6",children:e.jsx(De,{isAuthenticated:i,myDogs:u,selectedDogs:c,toggleDogSelection:ae,handleCheckIn:te,checkingIn:l,gardenIsOpen:P,navigate:a})}),e.jsx("div",{className:"px-4 mt-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 dark:border-gray-700",children:e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(de,{className:"h-5 w-5 mr-2 text-orange-500"}),"Who's Here Now"]})}),e.jsx("div",{className:"p-6",children:e.jsx(Re,{gardenId:t,ref:T})})]})}),e.jsx("div",{className:"px-4 mt-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"border-b border-gray-100 dark:border-gray-700",children:e.jsx("nav",{className:"flex",children:ne.map(o=>e.jsxs("button",{onClick:()=>S(o.id),className:`flex-1 flex items-center justify-center py-4 px-1 border-b-2 font-medium text-sm transition-all ${h===o.id?"border-purple-500 text-purple-600 dark:text-purple-400 bg-purple-50 dark:bg-purple-900/20":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[e.jsx(o.icon,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:o.name})]},o.id))})}),e.jsx("div",{className:"p-6",children:le()})]})}),e.jsx("div",{className:"px-4 mt-6 pb-6",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 p-6",children:e.jsx(fe,{garden:r})})})]}):e.jsx(Pe,{garden:r,onSubscriptionChange:re,onBack:U})]})})},Ee=({garden:t})=>{var a,m;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(E,{className:"h-5 w-5 mr-2 text-purple-500"}),"Location & Contact"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[e.jsx(E,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Address"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[t.location.address,", ",t.location.city]})]})]}),((a=t.contact)==null?void 0:a.phone)&&e.jsxs("div",{className:"flex items-start p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[e.jsx(we,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Phone"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:t.contact.phone})]})]}),((m=t.contact)==null?void 0:m.email)&&e.jsxs("div",{className:"flex items-start p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[e.jsx(J,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:t.contact.email})]})]})]})]}),t.openingHours&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Z,{className:"h-5 w-5 mr-2 text-blue-500"}),"Opening Hours"]}),e.jsx("div",{className:"space-y-2",children:Object.entries(t.openingHours).map(([i,r])=>e.jsxs("div",{className:"flex justify-between items-center text-sm p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[e.jsx("span",{className:"capitalize font-medium text-gray-700 dark:text-gray-300",children:i}),e.jsx("span",{className:`font-medium ${r!=null&&r.closed?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:r!=null&&r.closed?"Closed":`${(r==null?void 0:r.open)||""} - ${(r==null?void 0:r.close)||""}`})]},i))})]})]})},Fe=({amenities:t})=>e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Q,{className:"h-5 w-5 mr-2 text-yellow-500"}),"What this park offers"]}),t&&t.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-3",children:t.map(a=>e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[e.jsx(me,{className:"h-5 w-5 text-green-500 mr-3 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 capitalize font-medium",children:a.replace(/_/g," ")})]},a))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-3",children:"🏞️"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No amenities listed for this park."})]})]}),De=({isAuthenticated:t,myDogs:a,selectedDogs:m,toggleDogSelection:i,handleCheckIn:r,checkingIn:g,gardenIsOpen:u,navigate:N})=>t?a.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 p-6 text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"🐕"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Dogs Found"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"You need to add a dog to your profile before you can check in to parks."}),e.jsxs("button",{onClick:()=>N("/my-dogs"),className:"w-full inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-medium rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-200 transform hover:scale-105",children:[e.jsx(z,{className:"h-5 w-5 mr-2"}),"Add a Dog"]})]}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 dark:border-gray-700 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(Y,{className:"h-5 w-5 mr-2 text-purple-600"}),"Check In Your Dogs"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Select which dogs you want to bring:"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-3 mb-6 max-h-60 overflow-y-auto",children:a.map(f=>e.jsxs("label",{className:`flex items-center p-3 rounded-xl cursor-pointer border-2 transition-all duration-200 ${m.includes(f._id)?"bg-purple-50 dark:bg-purple-900/20 border-purple-500 shadow-md":"bg-gray-50 dark:bg-gray-700/50 border-transparent hover:border-purple-300 dark:hover:border-purple-600 hover:shadow-sm"}`,children:[e.jsx("input",{type:"checkbox",checked:m.includes(f._id),onChange:()=>i(f._id),className:"sr-only"}),e.jsx("div",{className:"h-10 w-10 bg-gradient-to-br from-orange-100 to-amber-100 dark:from-orange-900 dark:to-amber-900 rounded-full flex items-center justify-center text-lg mr-3 flex-shrink-0",children:"🐕"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm text-gray-900 dark:text-white",children:f.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:f.breed})]}),e.jsx("div",{className:"ml-auto",children:m.includes(f._id)&&e.jsx(je,{className:"h-6 w-6 text-purple-600"})})]},f._id))}),e.jsx("button",{onClick:r,disabled:g||m.length===0||!u,className:"w-full inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-medium rounded-xl hover:from-purple-600 hover:to-pink-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105 active:scale-95",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Checking in..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-5 w-5 mr-2"}),"Check In ",m.length," Dog",m.length>1?"s":""]})}),!u&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-xl",children:e.jsx("p",{className:"text-xs text-center text-red-600 dark:text-red-400 font-medium",children:"⚠️ This garden is currently closed"})})]})]}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 p-6 text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"🐕"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Join the Fun!"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Log in or create an account to check in your dogs and connect with other pet owners."}),e.jsxs("button",{onClick:()=>N("/login"),className:"w-full inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-medium rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-200 transform hover:scale-105",children:[e.jsx(oe,{className:"h-5 w-5 mr-2"}),"Log In or Sign Up"]})]}),Pe=({garden:t,onSubscriptionChange:a,onBack:m})=>{const{user:i}=F(),[r,g]=n.useState(!1),[u,N]=n.useState(!1),[f,C]=n.useState({events:!0,promotions:!0,announcements:!0,maintenance:!0}),[j,x]=n.useState({events:!0,promotions:!0,announcements:!0,maintenance:!0});n.useEffect(()=>{t&&w()},[t]);const w=async()=>{try{const c=await R.getNewsletterStatus(t._id);N(c.isSubscribed),c.preferences&&(C(c.preferences),x(c.preferences))}catch(c){console.error("Error loading subscription status:",c)}},d=async()=>{var c,s;if(!i){p.error("Please log in to subscribe to newsletters");return}g(!0);try{await R.subscribeToNewsletter(t._id,j),N(!0),C(j),p.success("Successfully subscribed to newsletter!"),a==null||a(!0),m()}catch(h){console.error("Error subscribing:",h),p.error(((s=(c=h.response)==null?void 0:c.data)==null?void 0:s.error)||"Failed to subscribe to newsletter")}finally{g(!1)}},l=async()=>{var c,s;g(!0);try{await R.unsubscribeFromNewsletter(t._id),N(!1),p.success("Successfully unsubscribed from newsletter"),a==null||a(!1),m()}catch(h){console.error("Error unsubscribing:",h),p.error(((s=(c=h.response)==null?void 0:c.data)==null?void 0:s.error)||"Failed to unsubscribe from newsletter")}finally{g(!1)}},b=(c,s)=>{x(h=>({...h,[c]:s}))};return e.jsx("div",{className:"px-4 mt-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-2xl",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx(UserIcon,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Subscription Details"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:i==null?void 0:i.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(UserIcon,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:[i==null?void 0:i.firstName," ",i==null?void 0:i.lastName]})]}),(i==null?void 0:i.dogs)&&i.dogs.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Dog: ",i.dogs[0].name]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(InformationCircleIcon,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Subscription Status"})]}),e.jsx("div",{className:`p-3 rounded-xl ${u?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-400":"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[u?e.jsx(CheckIcon,{className:"h-4 w-4"}):e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:u?"Subscribed":"Not Subscribed"})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(G,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"What would you like to receive?"})]}),e.jsx("div",{className:"space-y-3",children:[{key:"events",label:"Events & Activities",description:"Notifications about upcoming events and activities"},{key:"promotions",label:"Promotions & Offers",description:"Special offers and promotional content"},{key:"announcements",label:"General Announcements",description:"Important updates and news"},{key:"maintenance",label:"Maintenance Updates",description:"Information about closures and maintenance"}].map(c=>e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j[c.key],onChange:s=>b(c.key,s.target.checked),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c.label}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:c.description})]})]},c.key))})]}),e.jsx("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-2xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(InformationCircleIcon,{className:"h-5 w-5 text-blue-500 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"Newsletter Information"}),e.jsx("p",{className:"text-xs",children:"You can unsubscribe at any time using the link in our emails or by clicking the bell icon again. We respect your privacy and will only send relevant updates."})]})]})}),e.jsx("div",{className:"flex space-x-3",children:u?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:l,disabled:r,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:r?"Unsubscribing...":"Unsubscribe"}),e.jsx("button",{onClick:d,disabled:r,className:"flex-1 px-4 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:r?"Updating...":"Update Preferences"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:m,className:"flex-1 px-4 py-3 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{onClick:d,disabled:r,className:"flex-1 px-4 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:r?"Subscribing...":"Subscribe"})]})})]})})};export{es as default};
